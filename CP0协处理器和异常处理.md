MIPS实现CP0中的寄存器

| 标号     | 二进制       | 名称          | 描述                               |
| -------- | ------------ | ------------- | ---------------------------------- |
| ***9***  | ***001001*** | ***Count***   | ***处理器计数周期***               |
| ***11*** | ***001011*** | ***Compare*** | ***定时中断控制***                 |
| ***12*** | ***001100*** | ***Status***  | ***处理器状态和控制寄存器***       |
| ***13*** | ***001101*** | ***Cause***   | ***保存上一次异常原因***           |
| ***14*** | ***001110*** | ***EPC***     | ***保存上一次异常时的程序计数器*** |
| 15       | 001111       | PRID          | 处理器标志和版本                   |
| 16       | 010000       | Config        | 配置寄存器，设置CPU参数            |

==实现加粗斜体寄存器，后面两个不予实现==



Status寄存器字段

| 字段  | 名称    | 功能                                                         |
| ----- | ------- | ------------------------------------------------------------ |
| 31-28 | CU3-CU0 | 0001表示CP0存在                                              |
| 15-8  | IM7-0   | 是否屏蔽相应中断，mips共支持8个中断源，0屏蔽/1不屏蔽         |
| 1     | EXL     | 表示是否处于异常级(Exception Level)，异常发生时，此字段置为1 |
| 0     | IE      | 是否能中断(Interrupt Enable)，1中断使能/0中断禁止            |

备注：是否响应中断由 Status IM 和 Cause IP 对应字段以及 IE 共同控制



Cause寄存器

| 字段  | 名称    | 功能                           |
| ----- | ------- | ------------------------------ |
| 31    | BD      | 发生异常指令是否处于分支延迟槽 |
| 15-10 | IP7-2   | 指明外部硬件中断是否发生       |
| 9-8   | IP0-1   | 指明外部软件中断是否发生       |
| 6-2   | ExcCode | 异常编码                       |

ExcCode编码信息

| 标号 | 二进制 | 名称 | 描述           |
| ---- | ------ | ---- | -------------- |
| 0    | 00000  | Int  | 中断           |
| 8    | 01000  | Sys  | 系统调用       |
| 10   | 01010  | RI   | 执行未定义指令 |
| 12   | 01100  | Ov   | 整数溢出异常   |
| 13   | 01101  | Tr   | 自陷指令异常   |



协处理器访问指令

| COP0 31-25 | MT 25-21 | rt 20-16 | rd 15-11 | 10-3 | sel 2-0 | type              |
| ---------- | -------- | -------- | -------- | ---- | ------- | ----------------- |
| 010000     | 00100    | rt       | rd       | 0    | 弃用    | mtc0 写通用rt->rd |
| 010000     | 00000    | rt       | rd       | 0    | 弃用    | mfc0 读rd->通用rd |



MIPS支持异常处理及优先级

| 优先级 | 异常      | 描述                    |
| ------ | --------- | ----------------------- |
| 1      | Reset     | 硬件复位                |
| 7      | Interrupt | 6个硬件中断+2个软件中断 |
| 16     | Sys       | 执行了系统调用          |
|        | RI        | 无效指令                |
|        | Ov        | 算数指令溢出            |
|        | Tr        | 自陷指令                |

